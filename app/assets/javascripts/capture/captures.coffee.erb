applyMasonry = (grid) ->
  return grid.masonry {
    itemSelector: '.grid-item',
    gutterWidth: 5,
    isAnimated: true,
    animationOptions: {
      duration: 500,
      easing: 'swing'
    },
  }

$ ->
  $grid = applyMasonry $('#grid')
  msnry = $grid.data 'masonry'

  $container = $grid.infiniteScroll {
    # loading: {
    #   img:     "<%= image_url "loading.gif" %>",
    #   msgText: ""
    # },
    path: '.pagination .next a',
    append: '.grid-item',
    outlayer: msnry,
    scrollThreshold: 100,
    hideNav: '.pagination',
    status: '.page-load-status',
  }

$(document).on 'turbolinks:load', ->
  applyMasonry $('#grid')
