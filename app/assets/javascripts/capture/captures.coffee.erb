applyMasonry = (grid) ->
  return grid.masonry {
    itemSelector: '.grid-item',
    gutterWidth: 5,
    isAnimated: true,
    animationOptions: {
      duration: 500,
      easing: 'swing'
    },
  }

$(document).on 'turbolinks:load', ->
  $grid = applyMasonry $('#grid')
  msnry = $grid.data 'masonry'

  $container = $grid.infiniteScroll {
    path: '.pagination .next a',
    append: '.grid-item',
    outlayer: msnry,
    scrollThreshold: 10,
    hideNav: '.pagination a[rel=next]',
    status: '.page-load-status',
    debug: true,
  }
